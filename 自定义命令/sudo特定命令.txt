echo "Norm-rFing@xa2022!" |sudo -S echo "系统版本:";echo;cat /etc/redhat-release;echo;echo;lsb_release -a;echo;echo "用户唯一性:";echo;cat /etc/passwd |awk -F":" '{print $1}'|uniq -c;echo;echo "特权用户:";echo;awk -F: '$3==0 {print $1}' /etc/passwd;echo;echo "空密码用户:";echo;cat /etc/shadow |awk -F: 'length($2)==0 {print $1}';echo;echo "查看用户登录信息:";last;echo;echo "查看所有用户上次登录信息";echo;lastlog;echo;echo;echo "系统修改密码天数:";echo;cat /etc/login.defs|grep -v "#" |grep -v "^$";echo;echo "用户复杂度:";echo;cat /etc/pam.d/system-auth|grep "password";echo;cat /etc/pam.d/sshd|grep "password";echo;cat /etc/pam.d/login|grep "password";echo;echo "审计服务：";echo;ps aux |grep -E "rsyslog|auditd" |grep -v "echo";echo;echo;echo;echo "audit日志位置:";echo;cat /etc/audit/auditd.conf |grep "log_file ="|grep -v "max";echo;echo "前三行审计日志";echo;head -n 3 /var/log/audit/audit.log;echo;echo "后三行审计日志:";echo;tail -n 3 /var/log/audit/audit.log;echo;echo;echo "前三行messages日志：";echo;head -n 3 /var/log/messages;echo;echo "后五行messages日志";echo;tail -n 5 /var/log/messages;echo;echo;echo "审计策略";echo;auditctl -l;echo;echo;echo "审计目录权限";echo;ls -l /var/log/audit/;echo;echo "超时时间:";echo;cat /etc/profile |grep "TMOUT" |grep -v "echo";set |grep "TMOUT"|grep -v "echo";echo $TMOUT;echo;echo "Selinux状态：";echo;sestatus;echo;echo "IP限制:";echo;echo "IP限制（deny文件）:";cat /etc/hosts.deny |grep -v "#";echo;echo "IP限制(allow文件)";echo;cat /etc/hosts.allow |grep -v "#";echo;echo "防火墙策略：";echo;iptables -L;echo;echo "防火墙状态";echo;firewall-cmd --state;echo;service ufw status;echo;echo "是否开启TELNET,FTT,MAIL高危服务：";echo;ps aux |grep -E "telnet|sshd|ftp|mail" |grep -v "echo";echo;echo "硬盘大小:";echo;df -h;echo;echo "所有开放端口";echo;netstat -anpt;echo;echo "查看syslog配置信息:";cat /etc/rsyslog.conf  |grep -v "#" |grep -v "^$"